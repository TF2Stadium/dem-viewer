!function(e){"use strict";function t(){It=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)wt[t]=e[t],Pt[e.charCodeAt(t)]=t;Pt["-".charCodeAt(0)]=62,Pt["_".charCodeAt(0)]=63}function r(e){It||t();var r,n,i,a,o,s,u=e.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[u-2]?2:"="===e[u-1]?1:0,s=new Ct(3*u/4-o),i=o>0?u-4:u;var f=0;for(r=0,n=0;r<i;r+=4,n+=3)a=Pt[e.charCodeAt(r)]<<18|Pt[e.charCodeAt(r+1)]<<12|Pt[e.charCodeAt(r+2)]<<6|Pt[e.charCodeAt(r+3)],s[f++]=a>>16&255,s[f++]=a>>8&255,s[f++]=255&a;return 2===o?(a=Pt[e.charCodeAt(r)]<<2|Pt[e.charCodeAt(r+1)]>>4,s[f++]=255&a):1===o&&(a=Pt[e.charCodeAt(r)]<<10|Pt[e.charCodeAt(r+1)]<<4|Pt[e.charCodeAt(r+2)]>>2,s[f++]=a>>8&255,s[f++]=255&a),s}function n(e){return wt[e>>18&63]+wt[e>>12&63]+wt[e>>6&63]+wt[63&e]}function i(e,t,r){for(var i,a=[],o=t;o<r;o+=3)i=(e[o]<<16)+(e[o+1]<<8)+e[o+2],a.push(n(i));return a.join("")}function a(e){It||t();for(var r,n=e.length,a=n%3,o="",s=[],u=0,f=n-a;u<f;u+=16383)s.push(i(e,u,u+16383>f?f:u+16383));return 1===a?(r=e[n-1],o+=wt[r>>2],o+=wt[r<<4&63],o+="=="):2===a&&(r=(e[n-2]<<8)+e[n-1],o+=wt[r>>10],o+=wt[r>>4&63],o+=wt[r<<2&63],o+="="),s.push(o),s.join("")}function o(e,t,r,n,i){var a,o,s=8*i-n-1,u=(1<<s)-1,f=u>>1,l=-7,h=r?i-1:0,c=r?-1:1,p=e[t+h];for(h+=c,a=p&(1<<-l)-1,p>>=-l,l+=s;l>0;a=256*a+e[t+h],h+=c,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=n;l>0;o=256*o+e[t+h],h+=c,l-=8);if(0===a)a=1-f;else{if(a===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),a-=f}return(p?-1:1)*o*Math.pow(2,a-n)}function s(e,t,r,n,i,a){var o,s,u,f=8*a-i-1,l=(1<<f)-1,h=l>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,d=n?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),t+=o+h>=1?c/u:c*Math.pow(2,1-h),t*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(t*u-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(o=o<<i|s,f+=i;f>0;e[r+p]=255&o,p+=d,o/=256,f-=8);e[r+p-d]|=128*_}function u(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(e,t){if(u()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=l.prototype):(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,r){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return h(this,e,t,r)}function h(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?T(e,t,r,n):"string"==typeof t?_(e,t,r):y(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function p(e,t,r,n){return c(t),t<=0?f(e,t):void 0!==r?"string"==typeof n?f(e,t).fill(r,n):f(e,t).fill(r):f(e,t)}function d(e,t){if(c(t),e=f(e,t<0?0:0|v(t)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function _(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|m(t,r);e=f(e,n);var i=e.write(t,r);return i!==n&&(e=e.slice(0,i)),e}function g(e,t){var r=t.length<0?0:0|v(t.length);e=f(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function T(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),l.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=l.prototype):e=g(e,t),e}function y(e,t){if(E(t)){var r=0|v(t.length);return e=f(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||ee(t.length)?f(e,0):g(e,t);if("Buffer"===t.type&&At(t.data))return g(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function v(e){if(e>=u())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u().toString(16)+" bytes");return 0|e}function E(e){return!(null==e||!e._isBuffer)}function m(e,t){if(E(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(n)return q(e).length;t=(""+t).toLowerCase(),n=!0}}function S(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return F(this,t,r);case"ascii":return L(this,t,r);case"latin1":case"binary":return U(this,t,r);case"base64":return B(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function O(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function D(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),E(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,r/=2}var f;if(i){var l=-1;for(f=r;f<s;f++)if(a(e,f)===a(t,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===u)return l*o}else l!==-1&&(f-=f-l),l=-1}else for(r+u>s&&(r=s-u),f=r;f>=0;f--){for(var h=!0,c=0;c<u;c++)if(a(e,f+c)!==a(t,c)){h=!1;break}if(h)return f}return-1}function w(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[r+o]=s}return o}function P(e,t,r,n){return $(q(t,e.length-r),e,r,n)}function C(e,t,r,n){return $(J(t),e,r,n)}function I(e,t,r,n){return C(e,t,r,n)}function N(e,t,r,n){return $(Q(t),e,r,n)}function A(e,t,r,n){return $(Z(t,e.length-r),e,r,n)}function B(e,t,r){return a(0===t&&r===e.length?e:e.slice(t,r))}function F(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=r){var u,f,l,h;switch(s){case 1:a<128&&(o=a);break;case 2:u=e[i+1],128==(192&u)&&(h=(31&a)<<6|63&u)>127&&(o=h);break;case 3:u=e[i+1],f=e[i+2],128==(192&u)&&128==(192&f)&&(h=(15&a)<<12|(63&u)<<6|63&f)>2047&&(h<55296||h>57343)&&(o=h);break;case 4:u=e[i+1],f=e[i+2],l=e[i+3],128==(192&u)&&128==(192&f)&&128==(192&l)&&(h=(15&a)<<18|(63&u)<<12|(63&f)<<6|63&l)>65535&&h<1114112&&(o=h)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return R(n)}function R(e){var t=e.length;if(t<=Bt)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Bt));return r}function L(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function U(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=t;a<r;++a)i+=X(e[a]);return i}function x(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function M(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function H(e,t,r,n,i,a){if(!E(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function G(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-r,2);i<a;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function V(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-r,4);i<a;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function Y(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return i||Y(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),s(e,t,r,n,23,4),r+4}function W(e,t,r,n,i){return i||Y(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),s(e,t,r,n,52,8),r+8}function z(e){if(e=K(e).replace(Ft,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function K(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function X(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){t=t||1/0;for(var r,n=e.length,i=null,a=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function J(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function Z(e,t){for(var r,n,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,a.push(i),a.push(n);return a}function Q(e){return r(z(e))}function $(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function ee(e){return e!==e}function te(e){return null!=e&&(!!e._isBuffer||re(e)||ne(e))}function re(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function ne(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&re(e.slice(0,0))}function ie(e,t){var r=t.substr(0,t.length-1).split("}"),n=r.map(function(e){return e.split("{")});return function(r){var i={packetType:e};try{for(var a=0;a<n.length;a++){var o=Ut(r,n[a][1],i);"_"!==n[a][0]&&(i[n[a][0]]=o)}}catch(e){throw new Error("Failed reading pattern "+t+". "+e)}return i}}function ae(e){var t,r,n=Mt(e),i=e.readBits(9);return e.readBits(1)&&(r=e.readBits(11),t=e.readBits(12)),{packetType:"bspDecal",position:n,textureIndex:i,entIndex:r,modelIndex:t,lowPriority:e.readBoolean()}}function oe(e){for(var t=0;0!=(e>>=1);)t++;return t}function se(e){var t=e.readBits(16),r=e.readBoolean(),n=[];if(!r)for(var i=oe(t)+1,a=0;a<t;a++){var o={classId:e.readBits(i),className:e.readASCIIString(),dataTableName:e.readASCIIString()};n.push(o)}return{packetType:"classInfo",number:t,create:r,entries:n}}function ue(e,t){switch(e.readBits(2)){case 0:return e.readBits(4,t);case 1:return e.readBits(8,t);case 2:return e.readBits(12,t);case 3:return e.readBits(32,t)}throw new Error("Invalid var bit")}function fe(e,t){void 0===t&&(t=!1);for(var r=0,n=0;n<35;n+=7){var i=e.readBits(8);if(r|=(127&i)<<n,i>>7==0)break}return t?r>>1^-(1&r):r}function le(){throw new Error("setTimeout has not been defined")}function he(){throw new Error("clearTimeout has not been defined")}function ce(e){if(Gt===setTimeout)return setTimeout(e,0);if((Gt===le||!Gt)&&setTimeout)return Gt=setTimeout,setTimeout(e,0);try{return Gt(e,0)}catch(t){try{return Gt.call(null,e,0)}catch(t){return Gt.call(this,e,0)}}}function pe(e){if(Vt===clearTimeout)return clearTimeout(e);if((Vt===he||!Vt)&&clearTimeout)return Vt=clearTimeout,clearTimeout(e);try{return Vt(e)}catch(t){try{return Vt.call(null,e)}catch(t){return Vt.call(this,e)}}}function de(){Wt&&Yt&&(Wt=!1,Yt.length?jt=Yt.concat(jt):zt=-1,jt.length&&_e())}function _e(){if(!Wt){var e=ce(de);Wt=!0;for(var t=jt.length;t;){for(Yt=jt,jt=[];++zt<t;)Yt&&Yt[zt].run();zt=-1,t=jt.length}Yt=null,Wt=!1,pe(e)}}function ge(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];jt.push(new Te(e,t)),1!==jt.length||Wt||ce(_e)}function Te(e,t){this.fun=e,this.array=t}function ye(){}function ve(e){throw new Error("process.binding is not supported")}function Ee(){return"/"}function me(e){throw new Error("process.chdir is not supported")}function Se(){return 0}function Oe(e){var t=.001*or.call(ar),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]}function De(){return(new Date-sr)/1e3}function be(e,t,r,n,i){var a;for(a=0;a<i;a++)r[n+a]=e[t+a]}function we(e,t,r,n){var i;for(i=0;i<n;i++)e[t+i]=e[t-r+i]}function Pe(e){this.array=e,this.pos=0}function Ce(e){return e instanceof Uint8Array&&(!pr||!te(e))}function Ie(e){return e instanceof ArrayBuffer}function Ne(e){return!!pr&&te(e)}function Ae(e){if(!Ce(e)&&!Ie(e)&&!Ne(e))throw new TypeError(_r);var t=!1,r=!1;Ce(e)?t=!0:Ie(e)&&(r=!0,e=new Uint8Array(e));var n=new dr(e),i=n.readUncompressedLength();if(i===-1)throw new Error("Invalid Snappy bitstream");var a,o;if(t){if(a=new Uint8Array(i),!n.uncompressToBuffer(a))throw new Error("Invalid Snappy bitstream")}else if(r){if(a=new ArrayBuffer(i),o=new Uint8Array(a),!n.uncompressToBuffer(o))throw new Error("Invalid Snappy bitstream")}else if(a=new l(i),!n.uncompressToBuffer(a))throw new Error("Invalid Snappy bitstream");return a}function Be(e,t,r,n){for(var i=oe(t.maxEntries),a=-1,o=[],s=0;s<r;s++){var u=a+1;if(e.readBoolean()||(u=e.readBits(i)),a=u,u<0||u>t.maxEntries)throw new Error("Invalid string index for stringtable");var f=void 0;if(e.readBoolean()){if(e.readBoolean()){var l=e.readBits(5),h=e.readBits(5),c=e.readASCIIString();f=o[l].text?o[l].text.substr(0,h)+c:c}else f=e.readASCIIString()}var p=void 0;if(e.readBoolean())if(t.fixedUserDataSize&&t.fixedUserDataSizeBits)p=e.readBitStream(t.fixedUserDataSizeBits);else{var d=e.readBits(14);p=e.readBitStream(8*d)}if(t.entries[u]){var _=t.entries[u];p&&(_.extraData=p),f&&(_.text=f),o.push(_)}else t.entries[u]={text:f,extraData:p},o.push(t.entries[u]);o.length>32&&o.shift()}}function Fe(e,t){var r=e.readASCIIString(),n=e.readUint16(),i=oe(n),a=e.readBits(i+1),o=fe(e),s=0,u=0;e.readBoolean()&&(s=e.readBits(12),u=e.readBits(4));var f=e.readBoolean(),l=e.readBitStream(o);if(f){var h=l.readUint32(),c=l.readUint32(),p=l.readASCIIString(4),d=l.readArrayBuffer(c-4);if("SNAP"!==p)throw new Error("Unknown compressed stringtable format");var _=gr(d);if(_.byteLength!==h)throw new Error("Incorrect length of decompressed stringtable");l=new Lt(_.buffer)}var g={name:r,entries:[],maxEntries:n,fixedUserDataSize:s,fixedUserDataSizeBits:u};return Be(l,g,a,t),{packetType:"stringTable",tables:[g]}}function Re(e,t){return Tr(e)}function Le(e,t){var r=e.readBits(11),n=e.index+r,i=e.readBits(9),a=vr(i,e,t.eventDefinitions);return e.index=n,{packetType:"gameEvent",event:a}}function Ue(e,t){for(var r=e.readBits(9),n=(e.readBits(20),{}),i=0;i<r;i++){for(var a=e.readBits(9),o=e.readASCIIString(),s=e.readBits(3),u=[];0!==s;)u.push({type:s,name:e.readASCIIString()}),s=e.readBits(3);n[a]={id:a,name:o,entries:u}}return{packetType:"gameEventList",eventList:n}}function ke(e,t,r){for(var n=-1,i=t.flattenedProps;(n=Pr(r,n))!=-1;){if(n>=4096||n>i.length)throw new Error("prop index out of bounds while applying update for "+t.name+" got "+n+" property only has "+i.length+" properties");var a=i[n],o=e.getPropByDefinition(a),s=o?o:new Sr(a);s.value=wr.decode(a,r),o||e.props.push(s)}return e}function xe(e){return Cr[e.readBits(2)]}function Me(e,t,r){var n=r.serverClasses[e.readBits(r.classBits)],i=e.readBits(10);if(r.baseLineCache[n.id]){var a=r.baseLineCache[n.id].clone();return a.entityIndex=t,a.serialNumber=i,a}var o=new mr(n,t,yr.ENTER),s=r.getSendTable(n.dataTable);if(!s)throw new Error("Unknown SendTable for serverclass");var u=r.staticBaseLines[n.id];return u&&(u.index=0,ke(o,s,u),r.baseLineCache[n.id]=o.clone()),o.serialNumber=i,o}function He(e,t,r){if(!t.entityClasses[e])throw new Error('"unknown entity '+e+" for "+yr[r]+"("+r+")");return new mr(t.entityClasses[e],e,r)}function Ge(e,t,r){void 0===r&&(r=!1);var n=e.readBits(11),i=!!e.readBits(1),a=i?e.readInt32():0,o=e.readBits(1),s=e.readBits(11),u=e.readBits(20),f=e.readBoolean(),l=e.index+u,h=-1,c=[],p=[];if(!r){for(var d=0;d<s;d++){h+=1+Ht(e);var _=xe(e);if(_===yr.ENTER){var g=Me(e,h,t);if(ke(g,t.getSendTable(g.serverClass.dataTable),e),f){[].concat(g.props),t.baseLineCache[g.serverClass.id]=g.clone()}g.inPVS=!0,c.push(g)}else if(_===yr.PRESERVE){var g=He(h,t,_);ke(g,t.getSendTable(g.serverClass.dataTable),e),c.push(g)}else if(t.entityClasses[h]){var g=He(h,t,_);c.push(g)}}if(i)for(;e.readBoolean();){var T=e.readBits(11);p.push(T)}}return e.index=l,{packetType:"packetEntities",entities:c,removedEntities:p,maxEntries:n,isDelta:i,delta:a,baseLine:o,updatedEntries:s,length:u,updatedBaseLine:f}}function Ve(e){var t=e.readBoolean(),r=t?1:e.readUint8(),n=t?e.readUint8():e.readUint16();return e.index+=n,{packetType:"parseSounds",reliable:t,num:r,length:n}}function Ye(e){for(var t=e.readBits(8),r={},n=0;n<t;n++)r[e.readUTF8String()]=e.readUTF8String();return{packetType:"setConVar",vars:r}}function je(e,t){var r=e.readBits(5),n=e.readBoolean(),i=n?e.readBits(16):1,a=e.readBits(20),o=e.readBitStream(a);if(!t.stringTables[r])throw new Error("Table not found for update");var s=t.stringTables[r];return Be(o,s,i,t),{packetType:"stringTable",tables:[s]}}function We(e){var t,r,n,i=e.readBits(8),a=e.readBits(8),o=e.index;if(1===e.readBits(8)){if(7===e.readBits(8)){e.readUTF8String(6)}else e.index=o+8;if(r=e.readUTF8String(),"*DEAD*"===r.substr(0,6)){var s=r.indexOf(""),u=r.indexOf("");t=r.substr(s+1,u-s-1),r=r.substr(u+5),n="TF_Chat_AllDead"}}else e.index=o,n=e.readUTF8String(),t=e.readUTF8String(),r=e.readUTF8String(),e.readASCIIString(),e.readASCIIString();for(r=r.replace(/\u0001/g,""),r=r.replace(/\u0003/g,"");(o=r.indexOf(""))!==-1;)r=r.slice(0,o)+r.slice(o+7);return{packetType:"sayText2",client:i,raw:a,kind:n,from:t,text:r}}function ze(e){var t,r=e.readBits(8),n=e.readBits(11),i=e.index;return t=Ir[r]?Ir[r](e):{packetType:"unknownUserMessage",type:r},e.index=i+n,t}function Ke(e,t,r){void 0===r&&(r=!1);var n=e.readBits(8),i=Xe(e),a=e.index+i,o=null,s=[];if(!r){for(var u=0;u<n;u++){e.readBoolean()&&e.readUint8();if(e.readBoolean()){var f=e.readBits(t.classBits),l=t.serverClasses[f-1],h=t.getSendTable(l.dataTable);o=new mr(l,0,yr.ENTER),ke(o,h,e),s.push(o)}else{if(!o)throw new Error("no entity set to update");ke(o,t.getSendTable(o.serverClass.dataTable),e)}}if(a-e.index>8)throw new Error("unexpected content after TempEntities")}return e.index=a,{packetType:"tempEntities",entities:s}}function Xe(e){for(var t=0,r=0;r<35;r+=7){var n=e.readUint8();if(t|=(127&n)<<r,n>>7==0)return t}return t}function qe(e){var t=e.readASCIIString(),r=e.readUint8();return{packetType:"voiceInit",codec:t,quality:r,extraData:"vaudio_celt"===t&&255===r?e.readUint16():0}}function Je(e){var t=e.readUint8(),r=e.readUint8(),n=e.readUint16();return{packetType:"voiceData",client:t,proximity:r,length:n,data:e.readBitStream(n)}}function Ze(e){var t=e.readUint16(),r=e.readUint16();return{packetType:"menu",type:t,length:r,data:e.readBitStream(8*r)}}function Qe(e){var t=e.readUint32();return{packetType:"cmdKeyValues",length:t,data:e.readBitStream(t)}}function $e(){}function et(){et.init.call(this)}function tt(e){return void 0===e._maxListeners?et.defaultMaxListeners:e._maxListeners}function rt(e,t,r){if(t)e.call(r);else for(var n=e.length,i=ct(e,n),a=0;a<n;++a)i[a].call(r)}function nt(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=ct(e,i),o=0;o<i;++o)a[o].call(r,n)}function it(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,o=ct(e,a),s=0;s<a;++s)o[s].call(r,n,i)}function at(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var o=e.length,s=ct(e,o),u=0;u<o;++u)s[u].call(r,n,i,a)}function ot(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=ct(e,i),o=0;o<i;++o)a[o].apply(r,n)}function st(e,t,r,n){var i,a,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),o=a[t]):(a=e._events=new $e,e._eventsCount=0),o){if("function"==typeof o?o=a[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),!o.warned&&(i=tt(e))&&i>0&&o.length>i){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,ut(s)}}else o=a[t]=r,++e._eventsCount;return e}function ut(e){"function"==typeof console.warn?console.warn(e):console.log(e)}function ft(e,t,r){function n(){e.removeListener(t,n),i||(i=!0,r.apply(e,arguments))}var i=!1;return n.listener=r,n}function lt(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function ht(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function ct(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function pt(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function dt(e,t){for(var r=0,n=e.tables;r<n.length;r++){var i=n[r];if(t.getStringTable(i.name)||t.stringTables.push(i),"userinfo"===i.name)for(var a=0,o=i.entries;a<o.length;a++){var s=o[a];if(s.extraData&&s.extraData.bitsLeft>256){var u=s.extraData.readUTF8String(32),f=s.extraData.readUint32(),l=s.extraData.readUTF8String();if(l){var h=t.getUserInfo(f);h.name=u,h.steamId=l,h.entityId=parseInt(s.text,10)+1}}}if("instancebaseline"===i.name)for(var c=0,p=i.entries;c<p.length;c++){var d=p[c];d&&_t(d,t)}}}function _t(e,t){if(!e.extraData)throw new Error("Missing baseline");t.staticBaseLines[parseInt(e.text,10)]=e.extraData}function gt(e,t){t.chat.push({kind:e.kind,from:e.from,text:e.text,tick:t.tick})}function Tt(e,t){switch(e.event.name){case"player_death":for(var r=e.event.values;r.assister>256&&r.assister<16384;)r.assister-=256;for(var n=r.assister<256?r.assister:null;r.attacker>256;)r.attacker-=256;for(;r.userid>256;)r.userid-=256;t.deaths.push({killer:r.attacker,assister:n,victim:r.userid,weapon:r.weapon,tick:t.tick});break;case"teamplay_round_win":var r=e.event.values;6!==r.winreason&&t.rounds.push({winner:2===r.team?"red":"blue",length:r.round_time,end_tick:t.tick});break;case"player_spawn":var r=e.event.values,i=r.userid,a=t.getUserInfo(i),o=t.playerMap[a.entityId];a.team=2===r.team?"red":"blue";var s=r.class;o&&(o.classId=s,o.team=r.team),a.classes[s]||(a.classes[s]=0),a.classes[s]++;break;case"object_destroyed":var r=e.event.values;delete t.buildings[r.index];break;case"teamplay_round_start":t.buildings={}}}function yt(e,t){for(var r=0,n=e.removedEntities;r<n.length;r++){var i=n[r];delete t.entityClasses[i]}for(var a=0,o=e.entities;a<o.length;a++){var s=o[a];vt(s,t),Et(s,t)}}function vt(e,t){e.pvs===yr.DELETE&&delete t.entityClasses[e.entityIndex],t.entityClasses[e.entityIndex]=e.serverClass}function Et(e,t){for(var r=0,n=e.props;r<n.length;r++){var i=n[r];"DT_AttributeContainer"===i.definition.ownerTableName&&"m_hOuter"===i.definition.name&&(t.outerMap[i.value]||(t.outerMap[i.value]=e.entityIndex))}for(var a=0,o=e.props;a<o.length;a++){var i=o[a];"DT_BaseCombatWeapon"===i.definition.ownerTableName&&"m_hOwner"===i.definition.name&&(t.weaponMap[e.entityIndex]||(t.weaponMap[e.entityIndex]={className:e.serverClass.name,owner:i.value}))}switch(e.serverClass.name){case"CWorld":t.world.boundaryMin=e.getProperty("DT_WORLD","m_WorldMins").value,t.world.boundaryMax=e.getProperty("DT_WORLD","m_WorldMaxs").value;break;case"CTFPlayer":var s=t.playerMap[e.entityIndex]?t.playerMap[e.entityIndex]:new Wr(t,t.getUserInfoForEntity(e));t.playerMap[e.entityIndex]||(t.playerMap[e.entityIndex]=s,t.players.push(s));for(var u=0,f=e.props;u<f.length;u++){var i=f[u];"m_hMyWeapons"===i.definition.ownerTableName&&2097151!==i.value&&(s.weaponIds[parseInt(i.definition.name,10)]=i.value),"m_iAmmo"===i.definition.ownerTableName&&null!==i.value&&i.value>0&&(s.ammo[parseInt(i.definition.name,10)]=i.value);var l=i.definition.ownerTableName+"."+i.definition.name;switch(l){case"DT_BasePlayer.m_iHealth":s.health=i.value;break;case"DT_BasePlayer.m_iMaxHealth":s.maxHealth=i.value;break;case"DT_TFLocalPlayerExclusive.m_vecOrigin":s.position.x=i.value.x,s.position.y=i.value.y;break;case"DT_TFNonLocalPlayerExclusive.m_vecOrigin":s.position.x=i.value.x,s.position.y=i.value.y;break;case"DT_TFLocalPlayerExclusive.m_vecOrigin[2]":s.position.z=i.value;break;case"DT_TFNonLocalPlayerExclusive.m_vecOrigin[2]":s.position.z=i.value;break;case"DT_TFNonLocalPlayerExclusive.m_angEyeAngles[1]":s.viewAngle=i.value;break;case"DT_TFLocalPlayerExclusive.m_angEyeAngles[1]":s.viewAngle=i.value;break;case"DT_BasePlayer.m_lifeState":s.lifeState=i.value;break;case"DT_BaseCombatCharacter.m_hActiveWeapon":for(var h=0;h<s.weapons.length;h++)s.weaponIds[h]===i.value&&(s.activeWeapon=h)}}break;case"CWeaponMedigun":for(var c=t.weaponMap[e.entityIndex],p=0,d=e.props;p<d.length;p++){var i=d[p],l=i.definition.ownerTableName+"."+i.definition.name;switch(l){case"DT_WeaponMedigun.m_hHealingTarget":c.healTarget=i.value;break;case"DT_TFWeaponMedigunDataNonLocal.m_flChargeLevel":c.chargeLevel=i.value;break;case"DT_LocalTFWeaponMedigunData.m_flChargeLevel":c.chargeLevel=i.value}}break;case"CTFTeam":try{var _=e.getProperty("DT_Team","m_iTeamNum").value;t.teams[_]||(t.teams[_]={name:e.getProperty("DT_Team","m_szTeamname").value,score:e.getProperty("DT_Team","m_iScore").value,roundsWon:e.getProperty("DT_Team","m_iRoundsWon").value,players:e.getProperty("DT_Team",'"player_array"').value,teamNumber:_},t.teamMap[e.entityIndex]=t.teams[_])}catch(r){for(var g=t.teamMap[e.entityIndex],T=0,y=e.props;T<y.length;T++){var i=y[T],l=i.definition.ownerTableName+"."+i.definition.name;switch(l){case"DT_Team.m_iScore":g.score=i.value;break;case"DT_Team.m_szTeamname":g.name=i.value;break;case"DT_Team.m_iRoundsWon":g.roundsWon=i.value;break;case'DT_Team."player_array"':g.players=i.value}}}break;case"CObjectSentrygun":t.buildings[e.entityIndex]||(t.buildings[e.entityIndex]={type:"sentry",ammoRockets:0,ammoShells:0,autoAimTarget:0,builder:0,health:0,isBuilding:!1,isSapped:!1,level:0,maxHealth:0,playerControlled:!1,position:new br(0,0,0),shieldLevel:0,isMini:!1,team:0,angle:0});for(var v=t.buildings[e.entityIndex],E=0,m=e.props;E<m.length;E++){var i=m[E],l=i.definition.ownerTableName+"."+i.definition.name;switch(mt(v,i,l),l){case"DT_ObjectSentrygun.m_bPlayerControlled":v.playerControlled=i.value>0;break;case"DT_ObjectSentrygun.m_hAutoAimTarget":v.autoAimTarget=i.value;break;case"DT_ObjectSentrygun.m_nShieldLevel":v.shieldLevel=i.value;break;case"DT_ObjectSentrygun.m_iAmmoShells":v.ammoShells=i.value;break;case"DT_ObjectSentrygun.m_iAmmoRockets":v.ammoRockets=i.value;break;case"DT_BaseObject.m_bMiniBuilding":v.isMini=i.value>1;break;case"DT_TFNonLocalPlayerExclusive.m_angEyeAngles[1]":v.angle=i.value}}e.pvs&yr.LEAVE&&delete t.buildings[e.entityIndex];break;case"CObjectDispenser":t.buildings[e.entityIndex]||(t.buildings[e.entityIndex]={type:"dispenser",builder:0,health:0,isBuilding:!1,isSapped:!1,level:0,maxHealth:0,position:new br(0,0,0),team:0,healing:[],metal:0,angle:0});for(var S=t.buildings[e.entityIndex],O=0,D=e.props;O<D.length;O++){var i=D[O],l=i.definition.ownerTableName+"."+i.definition.name;switch(mt(S,i,l),l){case"DT_ObjectDispenser.m_iAmmoMetal":S.metal=i.value;break;case'DT_ObjectDispenser."healing_array"':S.healing=i.value}}e.pvs&yr.LEAVE&&delete t.buildings[e.entityIndex];break;case"CObjectTeleporter":t.buildings[e.entityIndex]||(t.buildings[e.entityIndex]={type:"teleporter",builder:0,health:0,isBuilding:!1,isSapped:!1,level:0,maxHealth:0,position:new br(0,0,0),team:0,isEntrance:!1,otherEnd:0,rechargeTime:0,rechargeDuration:0,timesUsed:0,angle:0,yawToExit:0});for(var b=t.buildings[e.entityIndex],w=0,P=e.props;w<P.length;w++){var i=P[w],l=i.definition.ownerTableName+"."+i.definition.name;switch(mt(b,i,l),l){case"DT_ObjectTeleporter.m_flRechargeTime":b.rechargeTime=i.value;break;case"DT_ObjectTeleporter.m_flCurrentRechargeDuration":b.rechargeDuration=i.value;break;case"DT_ObjectTeleporter.m_iTimesUsed":b.timesUsed=i.value;break;case"DT_ObjectTeleporter.m_bMatchBuilding":b.otherEnd=i.value;break;case"DT_ObjectTeleporter.m_flYawToExit":b.yawToExit=i.value;break;case"DT_BaseObject.m_iObjectMode":b.isEntrance=0===i.value}}e.pvs&yr.LEAVE&&delete t.buildings[e.entityIndex];break;case"CTFPlayerResource":for(var C=0,I=e.props;C<I.length;C++){var i=I[C],N=parseInt(i.definition.name,10),A=i.value;t.playerResources[N]||(t.playerResources[N]={alive:!1,arenaSpectator:!1,bonusPoints:0,chargeLevel:0,connected:!1,damageAssists:0,damageBlocked:0,deaths:0,dominations:0,healing:0,healingAssist:0,health:0,killStreak:0,maxBuffedHealth:0,maxHealth:0,nextRespawn:0,ping:0,playerClass:0,playerLevel:0,score:0,team:0,totalScore:0,damage:0});var B=t.playerResources[N];switch(i.definition.ownerTableName){case"m_iPing":B.ping=A;break;case"m_iScore":B.score=A;break;case"m_iDeaths":B.deaths=A;break;case"m_bConnected":B.connected=A>0;break;case"m_iTeam":B.team=A;break;case"m_bAlive":B.alive=A>0;break;case"m_iHealth":B.health=A;break;case"m_iTotalScore":B.totalScore=A;break;case"m_iMaxHealth":B.maxHealth=A;break;case"m_iMaxBuffedHealth":B.maxBuffedHealth=A;break;case"m_iPlayerClass":B.playerClass=A;break;case"m_bArenaSpectator":B.arenaSpectator=A>0;break;case"m_iActiveDominations":B.dominations=A;break;case"m_flNextRespawnTime":B.nextRespawn=A;break;case"m_iChargeLevel":B.chargeLevel=A;break;case"m_iDamage":B.damage=A;break;case"m_iDamageAssist":B.damageAssists=A;break;case"m_iHealing":B.healing=A;break;case"m_iHealingAssist":B.healingAssist=A;break;case"m_iDamageBlocked":B.damageBlocked=A;break;case"m_iBonusPoints":B.bonusPoints=A;break;case"m_iPlayerLevel":B.playerLevel=A;break;case"m_iKillstreak":B.killStreak=A}}break;case"CTeamRoundTimer":break;case"CLaserDot":}}function mt(e,t,r){switch(r){case"DT_BaseObject.m_iUpgradeLevel":e.level=t.value;break;case"DT_BaseObject.m_hBuilder":e.builder=t.value;break;case"DT_BaseObject.m_iMaxHealth":e.maxHealth=t.value;break;case"DT_BaseObject.m_iHealth":e.health=t.value;break;case"DT_BaseObject.m_bBuilding":e.isBuilding=t.value>0;break;case"DT_BaseObject.m_bHasSapper":e.isSapped=t.value>0;break;case"DT_BaseEntity.m_vecOrigin":e.position=t.value;break;case"DT_BaseEntity.m_iTeamNum":e.team=t.value;break;case"DT_BaseEntity.m_angRotation":e.angle=t.value.y}}function St(e,t){t.eventDefinitions=e.eventList}function Ot(e,t){t.sendTables=e.tables,t.serverClasses=e.serverClasses}function Dt(e,t){if(t<0)throw"cant shrink by negative length "+t;return e.slice(t,e.length)}var bt="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},wt=[],Pt=[],Ct="undefined"!=typeof Uint8Array?Uint8Array:Array,It=!1,Nt={}.toString,At=Array.isArray||function(e){return"[object Array]"==Nt.call(e)}
;l.TYPED_ARRAY_SUPPORT=void 0===bt.TYPED_ARRAY_SUPPORT||bt.TYPED_ARRAY_SUPPORT,l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,r){return h(null,e,t,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]),l.alloc=function(e,t,r){return p(null,e,t,r)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=te,l.compare=function(e,t){if(!E(e)||!E(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!At(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=l.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!E(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)O(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)O(this,t,t+3),O(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)O(this,t,t+7),O(this,t+1,t+6),O(this,t+2,t+5),O(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?F(this,0,e):S.apply(this,arguments)},l.prototype.equals=function(e){if(!E(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,r,n,i){if(!E(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var a=i-n,o=r-t,s=Math.min(a,o),u=this.slice(n,i),f=e.slice(t,r),l=0;l<s;++l)if(u[l]!==f[l]){a=u[l],o=f[l];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(e,t,r){return this.indexOf(e,t,r)!==-1},l.prototype.indexOf=function(e,t,r){return D(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return D(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return P(this,e,t,r);case"ascii":return C(this,e,t,r);case"latin1":case"binary":return I(this,e,t,r);case"base64":return N(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Bt=4096;l.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(l.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},l.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||M(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},l.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||M(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||M(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||M(e,t,this.length);for(var n=t,i=1,a=this[e+--n];n>0&&(i*=256);)a+=this[e+--n]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},l.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),o(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),o(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),o(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),o(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){H(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},l.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){H(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},l.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):G(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):G(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):V(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);H(this,e,t,r,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<r&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);H(this,e,t,r,i-1,-i)}var a=r-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):G(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):G(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):V(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return W(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return W(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,a=n-r;if(this===e&&r<t&&t<n)for(i=a-1;i>=0;--i)e[i+t]=this[i+r];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+a),t);return a},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var o=E(e)?e:q(new l(e,n).toString()),s=o.length;for(a=0;a<r-t;++a)this[a+t]=o[a%s]}return this};var Ft=/[^+\/0-9A-Za-z-_]/g,Rt=("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self,function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){!function(t){function r(e,t){return i(e,t,!1)}function n(e,t){return i(e,t,!0)}function i(e,t,r){if(0===t)return"";var n=0,i=[],a=!0,o=!!t;for(t||(t=Math.floor((e._length-e._index)/8));n<t;){var s=e.readUint8();if(0===s&&(a=!1,!o))break;a&&i.push(s),n++}var u=String.fromCharCode.apply(null,i);if(!r)return u;try{return decodeURIComponent(escape(u))}catch(e){return u}}function a(e,t,r){for(var n=r||t.length+1,i=0;i<n;i++)e.writeUint8(i<t.length?t.charCodeAt(i):0)}function o(e,t,r){for(var n=s(t),i=r||n.length+1,a=0;a<i;a++)e.writeUint8(a<n.length?n[a]:0)}function s(e){var t,r,n=[];for(t=0;t<e.length;t++)r=e.charCodeAt(t),r<=127?n.push(r):r<=2047?(n.push(r>>6|192),n.push(63&r|128)):r<=65535?(n.push(r>>12|224),n.push(r>>6&63|128),n.push(63&r|128)):(n.push(r>>18|240),n.push(r>>12&63|128),n.push(r>>6&63|128),n.push(63&r|128));return n}var u=function(e,t,r){if(!(e instanceof ArrayBuffer||void 0!==l&&e instanceof l))throw new Error("Must specify a valid ArrayBuffer or Buffer.");t=t||0,r=r||e.byteLength||e.length,this._view=new Uint8Array(e,t,r)};u._scratch=new DataView(new ArrayBuffer(8)),Object.defineProperty(u.prototype,"buffer",{get:function(){return new l(this._view)},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"byteLength",{get:function(){return this._view.length},enumerable:!0,configurable:!1}),u.prototype._setBit=function(e,t){t?this._view[e>>3]|=1<<(7&e):this._view[e>>3]&=~(1<<(7&e))},u.prototype.getBits=function(e,t,r){var n=8*this._view.length-e;if(t>n)throw new Error("Cannot get "+t+" bit(s) from offset "+e+", "+n+" available");for(var i=0,a=0;a<t;){var o=t-a,s=7&e,u=this._view[e>>3],f=Math.min(o,8-s);i|=(u>>s&(1<<f)-1)<<a,e+=f,a+=f}return r?(32!==t&&i&1<<t-1&&(i|=-1^(1<<t)-1),i):i>>>0},u.prototype.setBits=function(e,t,r){var n=8*this._view.length-e;if(r>n)throw new Error("Cannot set "+r+" bit(s) from offset "+e+", "+n+" available");for(var i=0;i<r;){var a;r-i>=8&&0==(7&e)?(this._view[e>>3]=255&t,a=8):(this._setBit(e,1&t),a=1),t>>=a,e+=a,i+=a}},u.prototype.getBoolean=function(e){return 0!==this.getBits(e,1,!1)},u.prototype.getInt8=function(e){return this.getBits(e,8,!0)},u.prototype.getUint8=function(e){return this.getBits(e,8,!1)},u.prototype.getInt16=function(e){return this.getBits(e,16,!0)},u.prototype.getUint16=function(e){return this.getBits(e,16,!1)},u.prototype.getInt32=function(e){return this.getBits(e,32,!0)},u.prototype.getUint32=function(e){return this.getBits(e,32,!1)},u.prototype.getFloat32=function(e){return u._scratch.setUint32(0,this.getUint32(e)),u._scratch.getFloat32(0)},u.prototype.getFloat64=function(e){return u._scratch.setUint32(0,this.getUint32(e)),u._scratch.setUint32(4,this.getUint32(e+32)),u._scratch.getFloat64(0)},u.prototype.setBoolean=function(e,t){this.setBits(e,t?1:0,1)},u.prototype.setInt8=u.prototype.setUint8=function(e,t){this.setBits(e,t,8)},u.prototype.setInt16=u.prototype.setUint16=function(e,t){this.setBits(e,t,16)},u.prototype.setInt32=u.prototype.setUint32=function(e,t){this.setBits(e,t,32)},u.prototype.setFloat32=function(e,t){u._scratch.setFloat32(0,t),this.setBits(e,u._scratch.getUint32(0),32)},u.prototype.setFloat64=function(e,t){u._scratch.setFloat64(0,t),this.setBits(e,u._scratch.getUint32(0),32),this.setBits(e+32,u._scratch.getUint32(4),32)},u.prototype.getArrayBuffer=function(e,t){for(var r=new Uint8Array(t),n=0;n<t;n++)r[n]=this.getUint8(e+8*n);return r};var f=function(e,t){return function(){if(this._index+t>this._length)throw new Error("Trying to read past the end of the stream");var r=this._view[e](this._index);return this._index+=t,r}},h=function(e,t){return function(r){this._view[e](this._index,r),this._index+=t}},c=function(e,t,r){var n=e instanceof ArrayBuffer||void 0!==l&&e instanceof l;if(!(e instanceof u||n))throw new Error("Must specify a valid BitView, ArrayBuffer or Buffer");this._view=n?new u(e,t,r):e,this._index=0,this._startIndex=0,this._length=8*this._view.byteLength};Object.defineProperty(c.prototype,"index",{get:function(){return this._index-this._startIndex},set:function(e){this._index=e+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"length",{get:function(){return this._length-this._startIndex},set:function(e){this._length=e+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"bitsLeft",{get:function(){return this._length-this._index},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"byteIndex",{get:function(){return Math.ceil(this._index/8)},set:function(e){this._index=8*e},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"buffer",{get:function(){return new l(this._view)},enumerable:!0,configurable:!1}),Object.defineProperty(c.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!1}),c.prototype.readBits=function(e,t){var r=this._view.getBits(this._index,e,t);return this._index+=e,r},c.prototype.writeBits=function(e,t){this._view.setBits(this._index,e,t),this._index+=t},c.prototype.readBoolean=f("getBoolean",1),c.prototype.readInt8=f("getInt8",8),c.prototype.readUint8=f("getUint8",8),c.prototype.readInt16=f("getInt16",16),c.prototype.readUint16=f("getUint16",16),c.prototype.readInt32=f("getInt32",32),c.prototype.readUint32=f("getUint32",32),c.prototype.readFloat32=f("getFloat32",32),c.prototype.readFloat64=f("getFloat64",64),c.prototype.writeBoolean=h("setBoolean",1),c.prototype.writeInt8=h("setInt8",8),c.prototype.writeUint8=h("setUint8",8),c.prototype.writeInt16=h("setInt16",16),c.prototype.writeUint16=h("setUint16",16),c.prototype.writeInt32=h("setInt32",32),c.prototype.writeUint32=h("setUint32",32),c.prototype.writeFloat32=h("setFloat32",32),c.prototype.writeFloat64=h("setFloat64",64),c.prototype.readASCIIString=function(e){return r(this,e)},c.prototype.readUTF8String=function(e){return n(this,e)},c.prototype.writeASCIIString=function(e,t){a(this,e,t)},c.prototype.writeUTF8String=function(e,t){o(this,e,t)},c.prototype.readBitStream=function(e){var t=new c(this._view);return t._startIndex=this._index,t._index=this._index,t.length=e,this._index+=e,t},c.prototype.readArrayBuffer=function(e){var t=this._view.getArrayBuffer(this._index,e);return this._index+=8*e,t},e.exports&&(e.exports={BitView:u,BitStream:c})}()})),Lt=Rt.BitStream,Ut=function(e,t,r){var n;if("b"===t[0])return e.readBoolean();if("s"===t[0])return 1===t.length?e.readUTF8String():(n=parseInt(t.substr(1),10),e.readASCIIString(n));if("f32"===t)return e.readFloat32();if("u"===t[0])return n=parseInt(t.substr(1),10),e.readBits(n);if("$"===t[0]){var i=t.substr(1);return e.readBits(r[i])}return e.readBits(parseInt(t,10),!0)},kt=function(){function e(e,t,r,n,i,a){void 0===a&&(a=[]),this.type=e,this.tick=t,this.stream=r,this.length=n,this.match=i,this.skippedPackets=a}return e}(),xt=function(e){var t=!!e.readBits(1),r=!!e.readBits(1),n=0;if(t||r){var i=!!e.readBits(1);t&&(n+=e.readBits(14)+1),r&&(n+=e.readBits(5)*(1/32)),i&&(n=-n)}return n},Mt=function(e){var t=!!e.readBits(1),r=!!e.readBits(1),n=!!e.readBits(1);return{x:t?xt(e):0,y:r?xt(e):0,z:n?xt(e):0}},Ht=ue,Gt=le,Vt=he;"function"==typeof bt.setTimeout&&(Gt=setTimeout),"function"==typeof bt.clearTimeout&&(Vt=clearTimeout);var Yt,jt=[],Wt=!1,zt=-1;Te.prototype.run=function(){this.fun.apply(null,this.array)};var Kt={},Xt=[],qt={},Jt={},Zt={},Qt=ye,$t=ye,er=ye,tr=ye,rr=ye,nr=ye,ir=ye,ar=bt.performance||{},or=ar.now||ar.mozNow||ar.msNow||ar.oNow||ar.webkitNow||function(){return(new Date).getTime()},sr=new Date,ur={nextTick:ge,title:"browser",browser:!0,env:Kt,argv:Xt,version:"",versions:qt,on:Qt,addListener:$t,once:er,off:tr,removeListener:rr,removeAllListeners:nr,emit:ir,binding:ve,cwd:Ee,chdir:me,umask:Se,hrtime:Oe,platform:"browser",release:Jt,config:Zt,uptime:De},fr=[0,255,65535,16777215,4294967295];Pe.prototype.readUncompressedLength=function(){for(var e,t,r=0,n=0;n<32&&this.pos<this.array.length;){if(e=this.array[this.pos],this.pos+=1,(t=127&e)<<n>>>n!==t)return-1;if(r|=t<<n,e<128)return r;n+=7}return-1},Pe.prototype.uncompressToBuffer=function(e){for(var t,r,n,i,a=this.array,o=a.length,s=this.pos,u=0;s<a.length;)if(t=a[s],s+=1,0==(3&t)){if((r=1+(t>>>2))>60){if(s+3>=o)return!1;n=r-60,r=a[s]+(a[s+1]<<8)+(a[s+2]<<16)+(a[s+3]<<24),r=1+(r&fr[n]),s+=n}if(s+r>o)return!1;be(a,s,e,u,r),s+=r,u+=r}else{switch(3&t){case 1:r=4+(t>>>2&7),i=a[s]+(t>>>5<<8),s+=1;break;case 2:if(s+1>=o)return!1;r=1+(t>>>2),i=a[s]+(a[s+1]<<8),s+=2;break;case 3:if(s+3>=o)return!1;r=1+(t>>>2),i=a[s]+(a[s+1]<<8)+(a[s+2]<<16)+(a[s+3]<<24),s+=4}if(0===i||i>u)return!1;we(e,u,i,r),u+=r}return!0};var lr,hr=Pe,cr={SnappyDecompressor:hr},pr=function(){return"object"==typeof ur&&"object"==typeof ur.versions&&void 0!==ur.versions.node}(),dr=cr.SnappyDecompressor,_r="Argument compressed must be type of ArrayBuffer, Buffer, or Uint8Array",gr=Ae,Tr=ie("entityMessage","index{11}classId{9}length{11}data{$length}");!function(e){e[e.STRING=1]="STRING",e[e.FLOAT=2]="FLOAT",e[e.LONG=3]="LONG",e[e.SHORT=4]="SHORT",e[e.BYTE=5]="BYTE",e[e.BOOLEAN=6]="BOOLEAN",e[e.LOCAL=7]="LOCAL"}(lr||(lr={}));var yr,vr=function(e,t,r){if(!r[e])throw new Error("unknown event type");for(var n=r[e],i={},a=0;a<n.entries.length;a++){var o=n.entries[a],s=Er(t,o);s&&(i[o.name]=s)}return{name:n.name,values:i}},Er=function(e,t){switch(t.type){case lr.STRING:return e.readUTF8String();case lr.FLOAT:return e.readFloat32();case lr.LONG:return e.readUint32();case lr.SHORT:return e.readUint16();case lr.BYTE:return e.readUint8();case lr.BOOLEAN:return e.readBoolean();case lr.LOCAL:return null;default:throw new Error("invalid game event type")}};!function(e){e[e.PRESERVE=0]="PRESERVE",e[e.ENTER=1]="ENTER",e[e.LEAVE=2]="LEAVE",e[e.DELETE=4]="DELETE"}(yr||(yr={}));var mr=function(){function e(e,t,r){this.serverClass=e,this.entityIndex=t,this.props=[],this.inPVS=!1,this.pvs=r}return e.prototype.getPropByDefinition=function(e){for(var t=0;t<this.props.length;t++)if(this.props[t].definition===e)return this.props[t];return null},e.prototype.getProperty=function(e,t){for(var r=0,n=this.props;r<n.length;r++){var i=n[r];if(i.definition.ownerTableName===e&&i.definition.name===t)return i}throw new Error("Property not found in entity ("+e+"."+t+")")},e.prototype.clone=function(){for(var t=new e(this.serverClass,this.entityIndex,this.pvs),r=0,n=this.props;r<n.length;r++){var i=n[r];t.props.push(i.clone())}return t},e}(),Sr=function(){function e(e){this.definition=e,this.value=null}return e.prototype.clone=function(){var t=new e(this.definition);return t.value=this.value,t},e}(),Or=function(){function t(e,t,r,n){this.type=e,this.name=t,this.flags=r,this.excludeDTName=null,this.lowValue=0,this.highValue=0,this.bitCount=0,this.table=null,this.numElements=0,this.arrayProperty=null,this.ownerTableName=n}return t.prototype.hasFlag=function(e){return 0!=(this.flags&e)},t.prototype.isExcludeProp=function(){return this.hasFlag(e.SendPropFlag.SPROP_EXCLUDE)},t.prototype.inspect=function(){var r={fromTable:this.ownerTableName,name:this.name,type:e.SendPropType[this.type],flags:t.formatFlags(this.flags),bitCount:this.bitCount};return this.type===e.SendPropType.DPT_Float&&(r.lowValue=this.lowValue,r.highValue=this.highValue),this.type===e.SendPropType.DPT_DataTable&&this.table&&(r.tableName=this.table.name),r},t.formatFlags=function(t){var r=[];for(var n in e.SendPropFlag){var i=e.SendPropFlag[n];"number"==typeof i&&t&i&&r.push(n)}return r},t}();!function(e){e[e.DPT_Int=0]="DPT_Int",e[e.DPT_Float=1]="DPT_Float",e[e.DPT_Vector=2]="DPT_Vector",e[e.DPT_VectorXY=3]="DPT_VectorXY",e[e.DPT_String=4]="DPT_String",e[e.DPT_Array=5]="DPT_Array",e[e.DPT_DataTable=6]="DPT_DataTable",e[e.DPT_NUMSendPropTypes=7]="DPT_NUMSendPropTypes"}(e.SendPropType||(e.SendPropType={})),function(e){e[e.SPROP_UNSIGNED=1]="SPROP_UNSIGNED",e[e.SPROP_COORD=2]="SPROP_COORD",e[e.SPROP_NOSCALE=4]="SPROP_NOSCALE",e[e.SPROP_ROUNDDOWN=8]="SPROP_ROUNDDOWN",e[e.SPROP_ROUNDUP=16]="SPROP_ROUNDUP",e[e.SPROP_NORMAL=32]="SPROP_NORMAL",e[e.SPROP_EXCLUDE=64]="SPROP_EXCLUDE",e[e.SPROP_XYZE=128]="SPROP_XYZE",e[e.SPROP_INSIDEARRAY=256]="SPROP_INSIDEARRAY",e[e.SPROP_PROXY_ALWAYS_YES=512]="SPROP_PROXY_ALWAYS_YES",e[e.SPROP_CHANGES_OFTEN=1024]="SPROP_CHANGES_OFTEN",e[e.SPROP_IS_A_VECTOR_ELEM=2048]="SPROP_IS_A_VECTOR_ELEM",e[e.SPROP_COLLAPSIBLE=4096]="SPROP_COLLAPSIBLE",e[e.SPROP_COORD_MP=8192]="SPROP_COORD_MP",e[e.SPROP_COORD_MP_LOWPRECISION=16384]="SPROP_COORD_MP_LOWPRECISION",e[e.SPROP_COORD_MP_INTEGRAL=32768]="SPROP_COORD_MP_INTEGRAL",e[e.SPROP_VARINT=32]="SPROP_VARINT"}(e.SendPropFlag||(e.SendPropFlag={}));var Dr,br=function(){function e(e,t,r){this.x=e,this.y=t,this.z=r}return e}(),wr=function(){function t(){}return t.decode=function(r,n){switch(r.type){case e.SendPropType.DPT_Int:return t.readInt(r,n);case e.SendPropType.DPT_Vector:return t.readVector(r,n);case e.SendPropType.DPT_VectorXY:return t.readVectorXY(r,n);case e.SendPropType.DPT_Float:return t.readFloat(r,n);case e.SendPropType.DPT_String:return t.readString(n);case e.SendPropType.DPT_Array:return t.readArray(r,n)}throw new Error("Unknown property type")},t.readInt=function(t,r){return t.hasFlag(e.SendPropFlag.SPROP_VARINT)?fe(r,!t.hasFlag(e.SendPropFlag.SPROP_UNSIGNED)):r.readBits(t.bitCount,!t.hasFlag(e.SendPropFlag.SPROP_UNSIGNED))},t.readArray=function(e,r){for(var n=e.numElements,i=1;0!=(n>>=1);)i++;var a=r.readBits(i),o=[];if(!e.arrayProperty)throw new Error("Array of undefined type");for(var s=0;s<a;s++){var u=t.decode(e.arrayProperty,r);if(u instanceof Array)throw new Error("Nested arrays not supported");o.push(u)}return o},t.readString=function(e){var t=e.readBits(9);return e.readASCIIString(t)},t.readVector=function(e,r){return new br(t.readFloat(e,r),t.readFloat(e,r),t.readFloat(e,r))},t.readVectorXY=function(e,r){return new br(t.readFloat(e,r),t.readFloat(e,r),0)},t.readFloat=function(r,n){if(r.hasFlag(e.SendPropFlag.SPROP_COORD))return t.readBitCoord(n);if(r.hasFlag(e.SendPropFlag.SPROP_COORD_MP))return t.readBitCoordMP(r,n,!1,!1);if(r.hasFlag(e.SendPropFlag.SPROP_COORD_MP_LOWPRECISION))return t.readBitCoordMP(r,n,!1,!0);if(r.hasFlag(e.SendPropFlag.SPROP_COORD_MP_INTEGRAL))return t.readBitCoordMP(r,n,!0,!1);if(r.hasFlag(e.SendPropFlag.SPROP_NOSCALE))return n.readFloat32();if(r.hasFlag(e.SendPropFlag.SPROP_NORMAL))return t.readBitNormal(n);var i=n.readBits(r.bitCount),a=i/((1<<r.bitCount)-1);return r.lowValue+(r.highValue-r.lowValue)*a},t.readBitNormal=function(e){var t=e.readBoolean(),r=e.readBits(11),n=r*(1/2047);return t?-n:n},t.readBitCoord=function(e){var t=e.readBoolean(),r=e.readBoolean();if(t||r){var n=e.readBoolean(),i=t?e.readBits(14)+1:0,a=r?e.readBits(5):0,o=i+a*(1/32);return n?-o:o}return 0},t.readBitCoordMP=function(e,t,r,n){var i=0,a=!1,o=t.readBoolean(),s=t.readBoolean();if(r){if(s)if(a=t.readBoolean(),o)i=t.readBits(11)+1;else if((i=t.readBits(14)+1)<2048)throw new Error("Something's fishy...")}else{a=t.readBoolean(),s&&(i=o?t.readBits(11)+1:t.readBits(14)+1);i+=t.readBits(n?3:5)*(1/(1<<(n?3:5)))}return a&&(i=-i),i},t}(),Pr=function(e,t){return e.readBoolean()?t+Ht(e)+1:-1},Cr={0:yr.PRESERVE,2:yr.ENTER,1:yr.LEAVE,3:yr.LEAVE+yr.DELETE};!function(e){e[e.Geiger=0]="Geiger",e[e.Train=1]="Train",e[e.HudText=2]="HudText",e[e.SayText=3]="SayText",e[e.SayText2=4]="SayText2",e[e.TextMsg=5]="TextMsg",e[e.ResetHUD=6]="ResetHUD",e[e.GameTitle=7]="GameTitle",e[e.ItemPickup=8]="ItemPickup",e[e.ShowMenu=9]="ShowMenu",e[e.Shake=10]="Shake",e[e.Fade=11]="Fade",e[e.VGUIMenu=12]="VGUIMenu",e[e.Rumble=13]="Rumble",e[e.CloseCaption=14]="CloseCaption",e[e.SendAudio=15]="SendAudio",e[e.VoiceMask=16]="VoiceMask",e[e.RequestState=17]="RequestState",e[e.Damage=18]="Damage",e[e.HintText=19]="HintText",e[e.KeyHintText=20]="KeyHintText",e[e.HudMsg=21]="HudMsg",e[e.AmmoDenied=22]="AmmoDenied",e[e.AchievementEvent=23]="AchievementEvent",e[e.UpdateRadar=24]="UpdateRadar",e[e.VoiceSubtitle=25]="VoiceSubtitle",e[e.HudNotify=26]="HudNotify",e[e.HudNotifyCustom=27]="HudNotifyCustom",e[e.PlayerStatsUpdate=28]="PlayerStatsUpdate",e[e.PlayerIgnited=29]="PlayerIgnited",e[e.PlayerIgnitedInv=30]="PlayerIgnitedInv",e[e.HudArenaNotify=31]="HudArenaNotify",e[e.UpdateAchievement=32]="UpdateAchievement",e[e.TrainingMsg=33]="TrainingMsg",e[e.TrainingObjective=34]="TrainingObjective",e[e.DamageDodged=35]="DamageDodged",e[e.PlayerJarated=36]="PlayerJarated",e[e.PlayerExtinguished=37]="PlayerExtinguished",e[e.PlayerJaratedFade=38]="PlayerJaratedFade",e[e.PlayerShieldBlocked=39]="PlayerShieldBlocked",e[e.BreakModel=40]="BreakModel",e[e.CheapBreakModel=41]="CheapBreakModel",e[e.BreakModel_Pumpkin=42]="BreakModel_Pumpkin",e[e.BreakModelRocketDud=43]="BreakModelRocketDud",e[e.CallVoteFailed=44]="CallVoteFailed",e[e.VoteStart=45]="VoteStart",e[e.VotePass=46]="VotePass",e[e.VoteFailed=47]="VoteFailed",e[e.VoteSetup=48]="VoteSetup",e[e.PlayerBonusPoints=49]="PlayerBonusPoints",e[e.SpawnFlyingBird=50]="SpawnFlyingBird",e[e.PlayerGodRayEffect=51]="PlayerGodRayEffect",e[e.SPHapWeapEvent=52]="SPHapWeapEvent",e[e.HapDmg=53]="HapDmg",e[e.HapPunch=54]="HapPunch",e[e.HapSetDrag=55]="HapSetDrag",e[e.HapSet=56]="HapSet",e[e.HapMeleeContact=57]="HapMeleeContact"}(Dr||(Dr={}));var Ir={4:We,5:ie("textMsg","destType{8}text{s}")},Nr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nr(t,e),t.prototype.parse=function(){for(var e=[],r=0;this.bitsLeft>6;){var n=this.stream.readBits(6);if(0!==n){if(!t.parsers[n])throw new Error("Unknown packet type "+n+" just parsed a "+Br[r]);var i=this.skippedPackets.indexOf(n)!==-1,a=t.parsers[n].call(this,this.stream,this.match,i);e.push(a),r=n}}return e},Object.defineProperty(t.prototype,"bitsLeft",{get:function(){return 8*this.length-this.stream.index},enumerable:!0,configurable:!0}),t}(kt);Ar.parsers={2:ie("file","transferId{32}fileName{s}requested{b}"),3:ie("netTick","tick{32}frameTime{16}stdDev{16}"),4:ie("stringCmd","command{s}"),5:Ye,6:ie("sigOnState","state{8}count{32}"),7:ie("print","value{s}"),8:ie("serverInfo","version{16}serverCount{32}stv{b}dedicated{b}maxCrc{32}maxClasses{16}mapHash{128}playerCount{8}maxPlayerCount{8}intervalPerTick{f32}platform{s1}game{s}map{s}skybox{s}serverName{s}replay{b}"),10:se,11:ie("setPause","paused{b}"),12:Fe,13:je,14:qe,15:Je,17:Ve,18:ie("setView","index{11}"),19:ie("fixAngle","relative{b}x{16}y{16}z{16}"),21:ae,23:ze,24:Re,25:Le,26:Ge,27:Ke,28:ie("preFetch","index{14}"),29:Ze,30:Ue,31:ie("getCvarValue","cookie{32}value{s}"),32:Qe};var Br;!function(e){e[e.file=2]="file",e[e.netTick=3]="netTick",e[e.stringCmd=4]="stringCmd",e[e.setConVar=5]="setConVar",e[e.sigOnState=6]="sigOnState",e[e.print=7]="print",e[e.serverInfo=8]="serverInfo",e[e.classInfo=10]="classInfo",e[e.setPause=11]="setPause",e[e.createStringTable=12]="createStringTable",e[e.updateStringTable=13]="updateStringTable",e[e.voiceInit=14]="voiceInit",e[e.voiceData=15]="voiceData",e[e.parseSounds=17]="parseSounds",e[e.setView=18]="setView",e[e.fixAngle=19]="fixAngle",e[e.bspDecal=21]="bspDecal",e[e.userMessage=23]="userMessage",e[e.entityMessage=24]="entityMessage",e[e.gameEvent=25]="gameEvent",e[e.packetEntities=26]="packetEntities",e[e.tempEntities=27]="tempEntities",e[e.preFetch=28]="preFetch",e[e.menu=29]="menu",e[e.gameEventList=30]="gameEventList",e[e.getCvarValue=30]="getCvarValue",e[e.cmdKeyValues=32]="cmdKeyValues"}(Br||(Br={}));var Fr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fr(t,e),t.prototype.parse=function(){return[{packetType:"consoleCmd",command:this.stream.readUTF8String()}]},t}(kt),Lr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lr(t,e),t.prototype.parse=function(){for(var e,t=this.stream.readUint8(),r=[],n=0;n<t;n++){for(var i=[],a=this.stream.readASCIIString(),o=this.stream.readUint16(),s=0;s<o;s++){var u=void 0;try{u={text:this.stream.readUTF8String()}}catch(e){return[{packetType:"stringTable",tables:r}]}if(this.stream.readBoolean()){if(8*(e=this.stream.readUint16())>this.stream.bitsLeft)return[{packetType:"stringTable",tables:r}];u.extraData=this.stream.readBitStream(8*e)}i.push(u)}var f={entries:i,name:a,maxEntries:o};r.push(f),this.stream.readBits(1)&&(this.stream.readASCIIString(),this.stream.readBits(1)&&(e=this.stream.readBits(16),this.stream.readBits(e)))}return[{packetType:"stringTable",tables:r}]},t.prototype.readExtraData=function(e){var t=this.stream.index+8*e,r=[]
;for(r.push(this.stream.readUTF8String());this.stream.index<t&&this.stream.index<this.stream.length-7;)try{var n=this.stream.readUTF8String();n&&r.push(n)}catch(e){return r}return this.stream.index=t,r},t}(kt),kr=function(){function t(e){this.name=e,this.props=[],this._flattenedProps=[]}return t.prototype.addProp=function(e){this.props.push(e)},t.prototype.flatten=function(){var t=this.excludes,r=[];this.getAllProps(t,r);for(var n=0,i=0;i<r.length;i++)if(r[i].hasFlag(e.SendPropFlag.SPROP_CHANGES_OFTEN)){if(i!=n){var a=r[i];r[i]=r[n],r[n]=a}n++}this._flattenedProps=r},t.prototype.getAllProps=function(e,t){var r=[];this.getAllPropsIteratorProps(e,r,t);for(var n=0,i=r;n<i.length;n++){var a=i[n];t.push(a)}},t.prototype.getAllPropsIteratorProps=function(t,r,n){for(var i=0,a=this.props;i<a.length;i++){var o=a[i];!function(i){i.hasFlag(e.SendPropFlag.SPROP_EXCLUDE)||t.indexOf(i)!==-1?"continue":t.filter(function(e){return e.name==i.name&&e.excludeDTName==i.ownerTableName}).length>0?"continue":void(i.type===e.SendPropType.DPT_DataTable&&i.table?i.hasFlag(e.SendPropFlag.SPROP_COLLAPSIBLE)?i.table.getAllPropsIteratorProps(t,r,n):i.table.getAllProps(t,n):r.push(i))}(o)}},Object.defineProperty(t.prototype,"flattenedProps",{get:function(){return 0===this._flattenedProps.length&&this.flatten(),this._flattenedProps},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"excludes",{get:function(){for(var t=[],r=0,n=this.props;r<n.length;r++){var i=n[r];i.hasFlag(e.SendPropFlag.SPROP_EXCLUDE)?t.push(i):i.type===e.SendPropType.DPT_DataTable&&i.table&&(t=t.concat(i.table.excludes))}return t},enumerable:!0,configurable:!0}),t}(),xr=function(){function e(e,t,r){this.id=e,this.name=t,this.dataTable=r}return e}(),Mr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Mr(r,t),r.prototype.parse=function(){for(var t,r=[],n={};this.stream.readBoolean();){var i=(this.stream.readBoolean(),this.stream.readASCIIString()),a=this.stream.readBits(10),o=new kr(i),s=void 0;for(t=0;t<a;t++){var u=this.stream.readBits(5),f=this.stream.readASCIIString(),l=this.stream.readBits(16),h=new Or(u,f,l,i);if(u===e.SendPropType.DPT_DataTable?h.excludeDTName=this.stream.readASCIIString():h.isExcludeProp()?h.excludeDTName=this.stream.readASCIIString():h.type===e.SendPropType.DPT_Array?h.numElements=this.stream.readBits(10):(h.lowValue=this.stream.readFloat32(),h.highValue=this.stream.readFloat32(),h.bitCount=this.stream.readBits(7)),h.hasFlag(e.SendPropFlag.SPROP_NOSCALE)&&(h.type===e.SendPropType.DPT_Float?h.bitCount=32:h.type===e.SendPropType.DPT_Vector&&(h.hasFlag(e.SendPropFlag.SPROP_NORMAL)||(h.bitCount=96))),s){if(h.type!==e.SendPropType.DPT_Array)throw"expected prop of type array";h.arrayProperty=s,s=null}if(h.hasFlag(e.SendPropFlag.SPROP_INSIDEARRAY)){if(s)throw new Error("array element already set");if(h.hasFlag(e.SendPropFlag.SPROP_CHANGES_OFTEN))throw new Error("unexpected CHANGES_OFTEN prop in array");s=h}else o.addProp(h)}r.push(o),n[o.name]=o}for(var c=0,p=r;c<p.length;c++)for(var o=p[c],d=0,_=o.props;d<_.length;d++){var h=_[d];h.type===e.SendPropType.DPT_DataTable&&h.excludeDTName&&(h.table=n[h.excludeDTName],h.excludeDTName=null)}var g=this.stream.readUint16(),T=[];if(g<=0)throw"expected one or more serverclasses";for(t=0;t<g;t++){var y=this.stream.readUint16();if(y>g)throw"invalid class id";var v=this.stream.readASCIIString(),E=this.stream.readASCIIString();T.push(new xr(y,v,E))}var m=8*this.length-this.stream.index;if(m>7||m<0)throw"unexpected remaining data in datatable ("+m+" bits)";return[{packetType:"dataTable",tables:r,serverClasses:T}]},r}(kt),Gr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gr(t,e),t.prototype.parse=function(){return[]},t}(kt);$e.prototype=Object.create(null),et.usingDomains=!1,et.prototype.domain=void 0,et.prototype._events=void 0,et.prototype._maxListeners=void 0,et.defaultMaxListeners=10,et.init=function(){this.domain=null,et.usingDomains&&(!(void 0).active||this instanceof(void 0).Domain||(this.domain=(void 0).active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new $e,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},et.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},et.prototype.getMaxListeners=function(){return tt(this)},et.prototype.emit=function(e){var t,r,n,i,a,o,s,u="error"===e;if(o=this._events)u=u&&null==o.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(r=o[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:rt(r,l,this);break;case 2:nt(r,l,this,arguments[1]);break;case 3:it(r,l,this,arguments[1],arguments[2]);break;case 4:at(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),a=1;a<n;a++)i[a-1]=arguments[a];ot(r,l,this,i)}return!0},et.prototype.addListener=function(e,t){return st(this,e,t,!1)},et.prototype.on=et.prototype.addListener,et.prototype.prependListener=function(e,t){return st(this,e,t,!0)},et.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,ft(this,e,t)),this},et.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,ft(this,e,t)),this},et.prototype.removeListener=function(e,t){var r,n,i,a,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener&&r.listener===t)0==--this._eventsCount?this._events=new $e:(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,a=r.length;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){o=r[a].listener,i=a;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new $e,this;delete n[e]}else ht(r,i);n.removeListener&&this.emit("removeListener",e,o||t)}return this},et.prototype.removeAllListeners=function(e){var t,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new $e,this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=new $e:delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),a=0;a<i.length;++a)"removeListener"!==(n=i[a])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new $e,this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},et.prototype.listeners=function(e){var t,r,n=this._events;return n?(t=n[e],r=t?"function"==typeof t?[t.listener||t]:pt(t):[]):r=[],r},et.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):lt.call(e,t)},et.prototype.listenerCount=lt,et.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Yr;!function(e){e[e.ALIVE=0]="ALIVE",e[e.DYING=1]="DYING",e[e.DEATH=2]="DEATH",e[e.RESPAWNABLE=3]="RESPAWNABLE"}(Yr||(Yr={}));var jr,Wr=function(){function e(e,t){this.position=new br(0,0,0),this.health=0,this.maxHealth=0,this.classId=0,this.team=0,this.viewAngle=0,this.weaponIds=[],this.ammo=[],this.lifeState=Yr.DEATH,this.activeWeapon=0,this.match=e,this.user=t}return Object.defineProperty(e.prototype,"weapons",{get:function(){var e=this;return this.weaponIds.map(function(t){return e.match.weaponMap[e.match.outerMap[t]]})},enumerable:!0,configurable:!0}),e}(),zr=function(){function e(){this.buildings={},this.playerResources=[],this.tick=0,this.chat=[],this.users={},this.deaths=[],this.rounds=[],this.startTick=0,this.intervalPerTick=0,this.stringTables=[],this.sendTables=[],this.serverClasses=[],this.staticBaseLines=[],this.eventDefinitions={},this.players=[],this.playerMap={},this.world={boundaryMin:{x:0,y:0,z:0},boundaryMax:{x:0,y:0,z:0}},this.entityClasses={},this.sendTableMap={},this.baseLineCache={},this.weaponMap={},this.outerMap={},this.teams=[],this.teamMap={},this.version=0}return e.prototype.getSendTable=function(e){if(this.sendTableMap[e])return this.sendTableMap[e];for(var t=0,r=this.sendTables;t<r.length;t++){var n=r[t];if(n.name===e)return this.sendTableMap[e]=n,n}throw new Error("unknown SendTable "+e)},e.prototype.getStringTable=function(e){for(var t=0,r=this.stringTables;t<r.length;t++){var n=r[t];if(n.name===e)return n}return null},e.prototype.getState=function(){var e={};for(var t in this.users){var r=this.users[t];this.users.hasOwnProperty(t)&&(e[t]={classes:r.classes,name:r.name,steamId:r.steamId,userId:r.userId},r.team&&(e[t].team=r.team))}return{chat:this.chat,users:e,deaths:this.deaths,rounds:this.rounds,startTick:this.startTick,intervalPerTick:this.intervalPerTick}},e.prototype.handlePacket=function(e){switch(e.packetType){case"packetEntities":yt(e,this);break;case"netTick":0===this.startTick&&(this.startTick=e.tick),this.tick=e.tick;break;case"serverInfo":this.intervalPerTick=e.intervalPerTick,this.version=e.version;break;case"sayText2":gt(e,this);break;case"dataTable":Ot(e,this);break;case"stringTable":dt(e,this);break;case"gameEventList":St(e,this);break;case"gameEvent":Tt(e,this)}},e.prototype.getUserInfo=function(e){for(;e>256;)e-=256;return this.users[e]||(this.users[e]={name:"",userId:e,steamId:"",classes:{},entityId:0,team:""}),this.users[e]},e.prototype.getUserInfoForEntity=function(e){for(var t=0,r=Object.keys(this.users);t<r.length;t++){var n=r[t],i=this.users[n];if(i&&i.entityId===e.entityIndex)return i}throw new Error("User not found for entity "+e.entityIndex)},e.prototype.getPlayerByUserId=function(e){for(var t=0,r=this.players;t<r.length;t++){var n=r[t];if(n.user.userId===e)return n}throw new Error("player not found for user id")},Object.defineProperty(e.prototype,"classBits",{get:function(){return Math.ceil(Math.log(this.serverClasses.length)*Math.LOG2E)},enumerable:!0,configurable:!0}),e}(),Kr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xr=function(e){function t(t,r){void 0===r&&(r=[]);var n=e.call(this)||this;return n.stream=t,n.match=new zr,n.on("packet",n.match.handlePacket.bind(n.match)),n.skipPackets=r,n}return Kr(t,e),t.prototype.readHeader=function(){return this.parseHeader(this.stream)},t.prototype.parseHeader=function(e){return{type:e.readASCIIString(8),version:e.readInt32(),protocol:e.readInt32(),server:e.readASCIIString(260),nick:e.readASCIIString(260),map:e.readASCIIString(260),game:e.readASCIIString(260),duration:e.readFloat32(),ticks:e.readInt32(),frames:e.readInt32(),sigon:e.readInt32()}},t.prototype.parseBody=function(){for(var e=!0;e;)e=this.tick();return this.emit("done",this.match),this.match},t.prototype.tick=function(){var e=this.readMessage(this.stream,this.match);return e instanceof kt&&this.handleMessage(e),!!e},t.prototype.parseMessage=function(e,t,r,n,i){switch(t){case jr.Sigon:case jr.Packet:return new Ar(t,r,e,n,i,this.skipPackets);case jr.ConsoleCmd:return new Rr(t,r,e,n,i,this.skipPackets);case jr.UserCmd:return new Vr(t,r,e,n,i,this.skipPackets);case jr.DataTables:return new Hr(t,r,e,n,i,this.skipPackets);case jr.StringTables:return new Ur(t,r,e,n,i,this.skipPackets);default:throw new Error("unknown message type")}},t.prototype.handleMessage=function(e){if(e.parse)for(var t=e.parse(),r=0;r<t.length;r++){var n=t[r];n&&this.emit("packet",n)}},t.prototype.readMessage=function(e,t){if(e.bitsLeft<8)return!1;var r=e.readBits(8);if(r===jr.Stop)return!1;var n=e.readInt32(),i=[],a=[];switch(r){case jr.Sigon:case jr.Packet:this.stream.readInt32();for(var o=0;o<2;o++){i[o]=[],a[o]=[];for(var s=0;s<3;s++)i[o][s]=this.stream.readInt32();for(var s=0;s<3;s++)a[o][s]=this.stream.readInt32();for(var s=0;s<3;s++)this.stream.readInt32()}this.stream.readInt32(),this.stream.readInt32();break;case jr.UserCmd:e.byteIndex+=4;break;case jr.SyncTick:return!0}var u=e.readInt32(),f=e.readBitStream(8*u);return this.parseMessage(f,r,n,u,t)},t}(et);!function(e){e[e.Sigon=1]="Sigon",e[e.Packet=2]="Packet",e[e.SyncTick=3]="SyncTick",e[e.ConsoleCmd=4]="ConsoleCmd",e[e.UserCmd=5]="UserCmd",e[e.DataTables=6]="DataTables",e[e.Stop=7]="Stop",e[e.StringTables=8]="StringTables"}(jr||(jr={}));var qr=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jr=function(e){function t(t){var r=e.call(this,new Lt(new ArrayBuffer(0)))||this;return r.sourceStream=t,r.on("packet",r.match.handlePacket.bind(r.match)),r.header=null,r.buffer=new l(0),r}return qr(t,e),t.prototype.eatBuffer=function(e){this.buffer=Dt(this.buffer,e)},t.prototype.start=function(){this.sourceStream.on("data",this.handleData.bind(this)),this.sourceStream.on("end",function(){this.emit("done",this.match)}.bind(this))},t.prototype.handleData=function(e){this.buffer=l.concat([this.buffer,e]),null===this.header?this.buffer.length>1072&&(this.header=this.parseHeader(new Lt(this.buffer)),this.eatBuffer(1072)):this.readStreamMessage()},t.prototype.readStreamMessage=function(){if(!(this.buffer.length<9)){var e=new Lt(this.buffer),t=e.readBits(8);if(t===jr.Stop)return void console.log("stop");var r=e.readInt32(),n=5,i=0;switch(t){case jr.Sigon:case jr.Packet:i+=84;break;case jr.UserCmd:i+=4;break;case jr.Stop:case jr.SyncTick:return void this.eatBuffer(n)}e.byteIndex+=i;var a=e.readInt32();if(n+=i+4,this.buffer.length<n+a)return void console.log("wants "+a);console.log("got message "+r);var o=e.readBitStream(8*a),s=this.parseMessage(o,t,r,a,this.match);this.handleMessage(s)}},t}(Xr),Zr=function(){function e(e){this.stream=new Lt(e)}return e.prototype.getParser=function(e){if(void 0===e&&(e=!1),!this.parser){var t=e?[Br.packetEntities,Br.tempEntities,Br.entityMessage]:[];this.parser=new Xr(this.stream,t)}return this.parser},e.fromNodeBuffer=function(t){for(var r=new ArrayBuffer(t.length),n=new Uint8Array(r),i=0;i<t.length;++i)n[i]=t[i];return new e(r)},e.fromNodeStream=function(e){return new Qr(e)},e}(),Qr=function(){function e(e){this.stream=e}return e.prototype.getParser=function(){return new Jr(this.stream)},e}();!function(e){e[e.TF_COND_AIMIN=1]="TF_COND_AIMIN",e[e.TF_COND_ZOOMED=2]="TF_COND_ZOOMED",e[e.TF_COND_DISGUISING=4]="TF_COND_DISGUISING",e[e.TF_COND_DISGUISED=8]="TF_COND_DISGUISED",e[e.TF_COND_STEALTHED=16]="TF_COND_STEALTHED",e[e.TF_COND_INVULNERABL=32]="TF_COND_INVULNERABL",e[e.TF_COND_TELEPORTED=64]="TF_COND_TELEPORTED",e[e.TF_COND_TAUNTING=128]="TF_COND_TAUNTING",e[e.TF_COND_INVULNERABLE_WEARINGOFF=256]="TF_COND_INVULNERABLE_WEARINGOFF",e[e.TF_COND_STEALTHED_BLIN=512]="TF_COND_STEALTHED_BLIN",e[e.TF_COND_SELECTED_TO_TELEPOR=1024]="TF_COND_SELECTED_TO_TELEPOR",e[e.TF_COND_CRITBOOSTED=2048]="TF_COND_CRITBOOSTED",e[e.TF_COND_TMPDAMAGEBONUS=4096]="TF_COND_TMPDAMAGEBONUS",e[e.TF_COND_FEIGN_DEATH=8192]="TF_COND_FEIGN_DEATH",e[e.TF_COND_PHAS=16384]="TF_COND_PHAS",e[e.TF_COND_STUNNED=32768]="TF_COND_STUNNED",e[e.TF_COND_OFFENSEBUF=65536]="TF_COND_OFFENSEBUF",e[e.TF_COND_SHIELD_CHARG=131072]="TF_COND_SHIELD_CHARG",e[e.TF_COND_DEMO_BUF=262144]="TF_COND_DEMO_BUF",e[e.TF_COND_ENERGY_BUF=524288]="TF_COND_ENERGY_BUF",e[e.TF_COND_RADIUSHEA=1048576]="TF_COND_RADIUSHEA",e[e.TF_COND_HEALTH_BUF=2097152]="TF_COND_HEALTH_BUF",e[e.TF_COND_BURNING=4194304]="TF_COND_BURNING",e[e.TF_COND_HEALTH_OVERHEALE=8388608]="TF_COND_HEALTH_OVERHEALE",e[e.TF_COND_URINE=16777216]="TF_COND_URINE",e[e.TF_COND_BLEEDING=33554432]="TF_COND_BLEEDING",e[e.TF_COND_DEFENSEBUFF=67108864]="TF_COND_DEFENSEBUFF",e[e.TF_COND_MAD_MILK=134217728]="TF_COND_MAD_MILK",e[e.TF_COND_MEGAHEAL=268435456]="TF_COND_MEGAHEAL",e[e.TF_COND_REGENONDAMAGEBUF=536870912]="TF_COND_REGENONDAMAGEBUF",e[e.TF_COND_MARKEDFORDEATH=1073741824]="TF_COND_MARKEDFORDEATH",e[e.TF_COND_NOHEALINGDAMAGEBUF=-2147483648]="TF_COND_NOHEALINGDAMAGEBUF",e[e.TF_COND_SPEED_BOOST=1]="TF_COND_SPEED_BOOST",e[e.TF_COND_CRITBOOSTED_PUMPKIN=2]="TF_COND_CRITBOOSTED_PUMPKIN",e[e.TF_COND_CRITBOOSTED_USER_BUFF=4]="TF_COND_CRITBOOSTED_USER_BUFF",e[e.TF_COND_CRITBOOSTED_DEMO_CHARGE=8]="TF_COND_CRITBOOSTED_DEMO_CHARGE",e[e.TF_COND_CRITBOOSTED_HYPE=16]="TF_COND_CRITBOOSTED_HYPE",e[e.TF_COND_CRITBOOSTED_FIRST_BLOOD=32]="TF_COND_CRITBOOSTED_FIRST_BLOOD",e[e.TF_COND_CRITBOOSTED_BONUS_TIME=64]="TF_COND_CRITBOOSTED_BONUS_TIME",e[e.TF_COND_CRITBOOSTED_CTF_CAPTURE=128]="TF_COND_CRITBOOSTED_CTF_CAPTURE",e[e.TF_COND_CRITBOOSTED_ON_KILL=256]="TF_COND_CRITBOOSTED_ON_KILL",e[e.TF_COND_CANNOT_SWITCH_FROM_MELEE=512]="TF_COND_CANNOT_SWITCH_FROM_MELEE",e[e.TF_COND_DEFENSEBUFF_NO_CRIT_BLOCK=1024]="TF_COND_DEFENSEBUFF_NO_CRIT_BLOCK",e[e.TF_COND_REPROGRAMME=2048]="TF_COND_REPROGRAMME",e[e.TF_COND_CRITBOOSTED_RAGE_BUF=4096]="TF_COND_CRITBOOSTED_RAGE_BUF",e[e.TF_COND_DEFENSEBUFF_HIG=8192]="TF_COND_DEFENSEBUFF_HIG",e[e.TF_COND_SNIPERCHARGE_RAGE_BUFF=16384]="TF_COND_SNIPERCHARGE_RAGE_BUFF",e[e.TF_COND_DISGUISE_WEARINGOF=32768]="TF_COND_DISGUISE_WEARINGOF",e[e.TF_COND_MARKEDFORDEATH_SILENT=65536]="TF_COND_MARKEDFORDEATH_SILENT",e[e.TF_COND_DISGUISED_AS_DISPENSE=131072]="TF_COND_DISGUISED_AS_DISPENSE",e[e.TF_COND_SAPPED=262144]="TF_COND_SAPPED",e[e.TF_COND_INVULNERABLE_HIDE_UNLESS_DAMAGE=524288]="TF_COND_INVULNERABLE_HIDE_UNLESS_DAMAGE",e[e.TF_COND_INVULNERABLE_USER_BUF=1048576]="TF_COND_INVULNERABLE_USER_BUF",e[e.TF_COND_HALLOWEEN_BOMB_HEAD=2097152]="TF_COND_HALLOWEEN_BOMB_HEAD",e[e.TF_COND_HALLOWEEN_THRILLER=4194304]="TF_COND_HALLOWEEN_THRILLER",e[e.TF_COND_RADIUSHEAL_ON_DAMAGE=8388608]="TF_COND_RADIUSHEAL_ON_DAMAGE",e[e.TF_COND_CRITBOOSTED_CARD_EFFECT=16777216]="TF_COND_CRITBOOSTED_CARD_EFFECT",e[e.TF_COND_INVULNERABLE_CARD_EFFECT=33554432]="TF_COND_INVULNERABLE_CARD_EFFECT",e[e.TF_COND_MEDIGUN_UBER_BULLET_RESIST=67108864]="TF_COND_MEDIGUN_UBER_BULLET_RESIST",e[e.TF_COND_MEDIGUN_UBER_BLAST_RESIST=134217728]="TF_COND_MEDIGUN_UBER_BLAST_RESIST",e[e.TF_COND_MEDIGUN_UBER_FIRE_RESIST=268435456]="TF_COND_MEDIGUN_UBER_FIRE_RESIST",e[e.TF_COND_MEDIGUN_SMALL_BULLET_RESIST=536870912]="TF_COND_MEDIGUN_SMALL_BULLET_RESIST",e[e.TF_COND_MEDIGUN_SMALL_BLAST_RESIST=1073741824]="TF_COND_MEDIGUN_SMALL_BLAST_RESIST",e[e.TF_COND_MEDIGUN_SMALL_FIRE_RESIST=-2147483648]="TF_COND_MEDIGUN_SMALL_FIRE_RESIST",e[e.TF_COND_STEALTHED_USER_BUF=1]="TF_COND_STEALTHED_USER_BUF",e[e.TF_COND_MEDIGUN_DEBUF=2]="TF_COND_MEDIGUN_DEBUF",e[e.TF_COND_STEALTHED_USER_BUFF_FADING=4]="TF_COND_STEALTHED_USER_BUFF_FADING",e[e.TF_COND_BULLET_IMMUNE=8]="TF_COND_BULLET_IMMUNE",e[e.TF_COND_BLAST_IMMUNE=16]="TF_COND_BLAST_IMMUNE",e[e.TF_COND_FIRE_IMMUNE=32]="TF_COND_FIRE_IMMUNE",e[e.TF_COND_PREVENT_DEATH=64]="TF_COND_PREVENT_DEATH",e[e.TF_COND_MVM_BOT_STUN_RADIOWAVE=128]="TF_COND_MVM_BOT_STUN_RADIOWAVE",e[e.TF_COND_HALLOWEEN_SPEED_BOOST=256]="TF_COND_HALLOWEEN_SPEED_BOOST",e[e.TF_COND_HALLOWEEN_QUICK_HEAL=512]="TF_COND_HALLOWEEN_QUICK_HEAL",e[e.TF_COND_HALLOWEEN_GIANT=1024]="TF_COND_HALLOWEEN_GIANT",e[e.TF_COND_HALLOWEEN_TINY=2048]="TF_COND_HALLOWEEN_TINY",e[e.TF_COND_HALLOWEEN_IN_HELL=4096]="TF_COND_HALLOWEEN_IN_HELL",e[e.TF_COND_HALLOWEEN_GHOST_MODE=8192]="TF_COND_HALLOWEEN_GHOST_MODE",e[e.TF_COND_MINICRITBOOSTED_ON_KILL=16384]="TF_COND_MINICRITBOOSTED_ON_KILL"}(e.PlayerCondition||(e.PlayerCondition={})),e.Demo=Zr,e.Parser=Xr,e.StreamParser=Jr,e.Match=zr,e.Player=Wr,e.PacketEntity=mr,e.SendPropDefinition=Or,e.SendProp=Sr,e.ServerClass=xr,e.Vector=br}(this.tf2demo=this.tf2demo||{});
